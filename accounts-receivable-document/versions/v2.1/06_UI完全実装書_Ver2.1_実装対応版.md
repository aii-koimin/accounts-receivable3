# 06_UIå®Œå…¨å®Ÿè£…æ›¸_Ver2.1_å®Ÿè£…å¯¾å¿œç‰ˆ
# å…¥é‡‘å·®ç•°ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  - UIå®Œå…¨å®Ÿè£…æ›¸ Ver2.1 å®Ÿè£…å¯¾å¿œç‰ˆ

## ğŸ¯ æ¦‚è¦

**ğŸš¨ å®Ÿè£…æ¤œè¨¼ç‰ˆ**: å®Ÿéš›ã®React/TypeScriptã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£… (1,228è¡ŒProgressDiscrepancyFlowBoard + 797è¡ŒDataImportPage + ãã®ä»–å®Ÿè£…æ¸ˆã¿ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ) ã¨å®Œå…¨å¯¾å¿œã—ãŸUIå®Ÿè£…ä»•æ§˜æ›¸

**æ¤œè¨¼æ¸ˆã¿æ©Ÿèƒ½**: å®Ÿéš›ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…ãƒ»5ã‚¹ãƒ†ãƒƒãƒ—é€²æ—ç®¡ç†ãƒ»AIä»‹å…¥ãƒ¬ãƒ™ãƒ«è¡¨ç¤ºãƒ»3ã¤ã®è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ãƒ»ãƒ•ã‚¡ã‚¤ãƒ«å–ã‚Šè¾¼ã¿ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰ãƒ»ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çµ±è¨ˆã®å®Œå…¨å®Ÿè£…

**ç›®çš„**: åŒç­‰ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Œå…¨å†ç¾  
**é‡è¦**: ã“ã®å®Ÿè£…æ¸ˆã¿ã‚³ãƒ¼ãƒ‰é€šã‚Šã«å®Ÿè£…ã™ã‚Œã°100%åŒç­‰æ©Ÿèƒ½ãŒå®Ÿç¾

**æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯**:
- React 18.2 + TypeScript 5.0 + Tailwind CSS 3.3.6
- Vite 5.0.8 (é«˜é€Ÿãƒ“ãƒ«ãƒ‰ãƒ»HMRå¯¾å¿œ)
- Lucide React (ã‚¢ã‚¤ã‚³ãƒ³ãƒ©ã‚¤ãƒ–ãƒ©ãƒª)
- React Query + React Hook Form (çŠ¶æ…‹ç®¡ç†)
- å®Ÿè£…æ¸ˆã¿ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ: 15+ (ãƒ¡ã‚¤ãƒ³æ©Ÿèƒ½å®Œå…¨å¯¾å¿œ)
- ç·å®Ÿè£…è¡Œæ•°: 3,500è¡Œä»¥ä¸Š (å®Ÿæ¸¬)
- UI/UX: å¿ƒç†çš„è² æ‹…è»½æ¸›è¨­è¨ˆãƒ»5ã‚¹ãƒ†ãƒƒãƒ—é€²æ—ãƒ»AIè‡ªå¾‹å‡¦ç†70%

## ğŸ¯ å¯¾è±¡èª­è€…
- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºè€…
- UI/UXè¨­è¨ˆè€…
- ã‚·ã‚¹ãƒ†ãƒ å†æ§‹ç¯‰æ‹…å½“è€…
- Vibe Codingå®Ÿè£…è€…

## âš¡ å®Ÿè£…æ¦‚è¦
- **æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯**: React 18.2 + TypeScript 5.0 + Tailwind CSS 3.4
- **ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ•°**: 15å€‹ï¼ˆä¸»è¦7å€‹ + å…±é€š8å€‹ï¼‰
- **ç·å®Ÿè£…è¡Œæ•°**: ç´„3,500è¡Œï¼ˆå®Ÿè£…æ¸ˆã¿æ¤œè¨¼æ¸ˆã¿ï¼‰
- **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ**: ãƒ¢ãƒã‚¤ãƒ«ãƒ»ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆãƒ»ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—å®Œå…¨å¯¾å¿œ

---

## ğŸ—ï¸ **ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆï¼ˆå®Ÿè£…æ¤œè¨¼æ¸ˆã¿ï¼‰**

### **å®Ÿéš›ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆéšå±¤æ§‹é€ **

```yaml
# å®Ÿè£…æ¸ˆã¿ãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆ
src/
â”œâ”€â”€ components/                    # å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ common/                    # åŸºæœ¬UIéƒ¨å“
â”‚   â”‚   â”œâ”€â”€ LoadingSpinner.tsx     # ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
â”‚   â”‚   â”œâ”€â”€ Button.tsx             # æ±ç”¨ãƒœã‚¿ãƒ³
â”‚   â”‚   â”œâ”€â”€ Modal.tsx              # ãƒ¢ãƒ¼ãƒ€ãƒ«
â”‚   â”‚   â””â”€â”€ NotificationToast.tsx  # é€šçŸ¥ãƒˆãƒ¼ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ forms/                     # ãƒ•ã‚©ãƒ¼ãƒ é–¢é€£
â”‚   â”‚   â”œâ”€â”€ FormField.tsx          # ãƒ•ã‚©ãƒ¼ãƒ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
â”‚   â”‚   â”œâ”€â”€ SelectField.tsx        # ã‚»ãƒ¬ã‚¯ãƒˆ
â”‚   â”‚   â””â”€â”€ TextareaField.tsx      # ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢
â”‚   â”œâ”€â”€ discrepancy/               # å·®ç•°ç®¡ç†å°‚ç”¨ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
â”‚   â”‚   â””â”€â”€ ProgressDiscrepancyFlowBoard.tsx  # 1,228è¡Œãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â””â”€â”€ layout/                    # ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â”‚       â”œâ”€â”€ MainLayout.tsx         # ãƒ¡ã‚¤ãƒ³ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â”‚       â”œâ”€â”€ Sidebar.tsx            # ã‚µã‚¤ãƒ‰ãƒãƒ¼
â”‚       â””â”€â”€ Header.tsx             # ãƒ˜ãƒƒãƒ€ãƒ¼
â”œâ”€â”€ pages/                         # ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
â”‚   â”œâ”€â”€ dashboard/                 # ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ tasks/                     # ã‚¿ã‚¹ã‚¯ç®¡ç†ãƒšãƒ¼ã‚¸
â”‚   â”‚   â””â”€â”€ TasksPage.tsx          # ã‚¿ã‚¹ã‚¯ä¸€è¦§è¡¨ç¤º
â”‚   â”œâ”€â”€ data-import/               # ãƒ‡ãƒ¼ã‚¿å–ã‚Šè¾¼ã¿ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
â”‚   â”‚   â””â”€â”€ DataImportPage.tsx     # 797è¡Œãƒ•ã‚¡ã‚¤ãƒ«å–ã‚Šè¾¼ã¿ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ email/                     # ãƒ¡ãƒ¼ãƒ«ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ EmailSettingsPage.tsx      # SMTPè¨­å®šç”»é¢
â”‚   â”‚   â””â”€â”€ EmailTemplatesPage.tsx    # ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç®¡ç†
â”‚   â””â”€â”€ settings/                  # è¨­å®š
â”œâ”€â”€ services/                      # APIé€šä¿¡ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
â”‚   â””â”€â”€ api.ts                     # REST API ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”œâ”€â”€ types/                         # TypeScriptå‹å®šç¾©ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
â”‚   â””â”€â”€ discrepancy.ts             # å·®ç•°ç®¡ç†å‹å®šç¾©
â””â”€â”€ styles/                        # Tailwind CSS
```

### çŠ¶æ…‹ç®¡ç†ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
```typescript
// å®Ÿè£…æ¸ˆã¿çŠ¶æ…‹ç®¡ç†ãƒ‘ã‚¿ãƒ¼ãƒ³
- ãƒ­ãƒ¼ã‚«ãƒ«çŠ¶æ…‹: useState + useEffect
- ãƒ•ã‚©ãƒ¼ãƒ ç®¡ç†: React Hook Form + validation
- APIçŠ¶æ…‹ç®¡ç†: ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯å®Ÿè£…
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°: WebSocket + EventSource
- é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ : react-hot-toast
```

---

## ğŸš€ **ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…ï¼ˆå®Ÿè£…æ¤œè¨¼æ¸ˆã¿ï¼‰**

### **1. ProgressDiscrepancyFlowBoard.tsx (1,228è¡Œå®Ÿè£…æ¸ˆã¿)**
**æ¦‚è¦**: å·®ç•°ç®¡ç†ãƒ¡ã‚¤ãƒ³UI - 5ã‚¹ãƒ†ãƒƒãƒ—é€²æ—ãƒ»3è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ãƒ»AIä»‹å…¥è¡¨ç¤º

#### **å®Ÿè£…æ¸ˆã¿ä¸»è¦æ©Ÿèƒ½**
```typescript
// å®Ÿéš›ã®å®Ÿè£…æ¸ˆã¿ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
interface ProgressDiscrepancyFlowBoardProps {
  discrepancies: PaymentDiscrepancy[];
  onStatusChange: (discrepancyId: string, newStatus: DiscrepancyStatus) => void;
  onDiscrepancyClick: (discrepancy: PaymentDiscrepancy) => void;
  onRefresh?: () => void;
  onEdit?: (discrepancy: PaymentDiscrepancy) => void;
  onDelete?: (discrepancyId: string) => void;
  loading?: boolean;
}

// å®Ÿè£…æ¸ˆã¿è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰
type DisplayMode = 'flow' | 'table' | 'list';
type FlowView = 'separated' | 'unified';
```

#### **5ã‚¹ãƒ†ãƒƒãƒ—é€²æ—è¡¨ç¤ºï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰**
```typescript
// å®Ÿéš›ã®å®Ÿè£…æ¸ˆã¿é€²æ—ã‚¹ãƒ†ãƒƒãƒ—å®šç¾©
const progressSteps = [
  { id: 1, name: 'å…¥é‡‘å·®ç•°æ¤œçŸ¥', icon: 'ğŸ”' },
  { id: 2, name: 'ç£ä¿ƒãƒ¡ãƒ¼ãƒ«é€ä»˜æ¸ˆã¿', icon: 'ğŸ“§' },
  { id: 3, name: 'å…ˆæ–¹é€£çµ¡ã‚’å–ã‚ŒãŸ', icon: 'ğŸ“' },
  { id: 4, name: 'è§£æ±ºæ–¹æ³•åˆæ„æ¸ˆã¿', icon: 'ğŸ¤' },
  { id: 5, name: 'è§£æ±ºæ¸ˆã¿', icon: 'âœ…' }
];

// ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‹ã‚‰ç¾åœ¨ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’è¨ˆç®—ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
const getCurrentStep = (discrepancy: PaymentDiscrepancy): number => {
  const { status, interventionLevel } = discrepancy;
  
  switch (status) {
    case 'detected':
    case 'ai_analyzing':
      return 1; // æ¤œçŸ¥æ®µéš
    case 'ai_action_ready':
    case 'ai_executing':
    case 'human_review':
    case 'human_action':
      return 2; // ãƒ¡ãƒ¼ãƒ«é€ä»˜æ®µéš
    case 'ai_phone_scheduled':
    case 'customer_response':
      return 3; // é€£çµ¡å–å¾—æ®µéš
    case 'escalated':
      return 4; // åˆæ„æ®µéš
    case 'resolved':
      return 5; // è§£æ±ºæ¸ˆã¿
    default:
      return 1;
  }
};
```

#### **é€²æ—ã‚¹ãƒ†ãƒƒãƒ—ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰**
```typescript
// å®Ÿéš›ã®å®Ÿè£…æ¸ˆã¿ProgressStepsã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
const ProgressSteps: React.FC<{ currentStep: number }> = ({ currentStep }) => (
  <div className="flex items-center space-x-2">
    {progressSteps.map((step, index) => (
      <React.Fragment key={step.id}>
        <div className="flex flex-col items-center">
          <div 
            className={`w-8 h-8 rounded-full flex items-center justify-center text-xs font-medium transition-all ${
              step.id <= currentStep 
                ? 'bg-blue-500 text-white' 
                : 'bg-gray-200 text-gray-500'
            }`}
          >
            {step.id <= currentStep ? step.icon : step.id}
          </div>
          <span className={`text-xs mt-1 text-center max-w-16 leading-tight ${
            step.id <= currentStep ? 'text-blue-600 font-medium' : 'text-gray-400'
          }`}>
            {step.name}
          </span>
        </div>
        {index < progressSteps.length - 1 && (
          <div 
            className={`flex-1 h-0.5 mx-1 transition-all ${
              step.id < currentStep ? 'bg-blue-500' : 'bg-gray-200'
            }`}
            style={{ minWidth: '20px' }}
          />
        )}
      </React.Fragment>
    ))}
  </div>
);
```

#### **AIä»‹å…¥ãƒ¬ãƒ™ãƒ«å¯è¦–åŒ–ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰**
```typescript
// å®Ÿè£…æ¸ˆã¿AIä»‹å…¥ãƒ¬ãƒ™ãƒ«è¡¨ç¤º
const getStageByStatus = (discrepancy: PaymentDiscrepancy): string => {
  const { status, interventionLevel, priority, daysPastDue } = discrepancy;
  
  // AIåˆ†æã‹ã‚‰æ®µéšåˆ¤å®š
  let escalationStage = 1;
  try {
    const aiAnalysis = typeof discrepancy.aiAnalysis === 'string' 
      ? JSON.parse(discrepancy.aiAnalysis) 
      : discrepancy.aiAnalysis;
    escalationStage = aiAnalysis?.escalationStage || 1;
  } catch (e) {
    // ãƒ‘ãƒ¼ã‚¹å¤±æ•—æ™‚ã¯ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‹ã‚‰æ¨å®š
  }

  // åˆæœŸæ¤œçŸ¥æ®µéšã§ã¯åŸºæœ¬çš„ã«AIè‡ªå¾‹ã§ã‚¹ã‚¿ãƒ¼ãƒˆ
  if (status === 'detected' && interventionLevel !== 'human_required') {
    return 'ai_detected'; // AIè‡ªå¾‹å‡¦ç†é–‹å§‹
  }

  // äººé–“ä»‹å…¥å¿…é ˆã®ä¾‹å¤–ã‚±ãƒ¼ã‚¹ï¼ˆæœ€å°é™ï¼‰
  if (interventionLevel === 'human_required') {
    switch (status) {
      case 'human_review': return 'human_review_needed';
      case 'human_action':
        // ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ®µéšã«å¿œã˜ãŸåˆ¤å®š
        if (escalationStage >= 4) { // 3æ®µéšå¾Œã«äººé–“å¯¾å¿œ
          if (priority === 'critical' || (daysPastDue && daysPastDue > 60)) {
            return 'legal_phone_action';
          }
          if (daysPastDue && daysPastDue > 30) {
            return 'phone_negotiation';
          }
          return 'phone_call_required';
        }
        return 'human_email_review';
      case 'resolved': return 'ai_resolved'; // è§£æ±ºã¯åŸºæœ¬AI
      default: return 'human_email_review';
    }
  }
  
  // AIè‡ªå¾‹å‡¦ç†ï¼ˆãƒ¡ã‚¤ãƒ³å‡¦ç†ãƒ•ãƒ­ãƒ¼ï¼‰
  switch (status) {
    case 'detected': return 'ai_detected';
    case 'ai_analyzing': return 'ai_analyzing';
    case 'ai_action_ready': return 'ai_email_ready';
    case 'ai_executing': return 'ai_email_sent';
    case 'ai_phone_scheduled': return 'ai_phone_scheduled';
    case 'customer_response': return 'ai_monitoring';
    case 'escalated': // 3æ®µéšå¾Œã®ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
      if (escalationStage >= 4) {
        return priority === 'critical' ? 'phone_call_required' : 'human_review_needed';
      }
      return 'ai_monitoring';
    case 'resolved': return 'ai_resolved'; // åŸºæœ¬çš„ã«AIè§£æ±º
    default: return 'ai_detected';
  }
};
```

#### **3ã¤ã®è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰å®Ÿè£…ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰**

**Flowè¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰**
```typescript
// å®Ÿè£…æ¸ˆã¿Flowè¡¨ç¤ºï¼ˆãƒ–ãƒ­ãƒƒã‚¯è¡¨ç¤ºï¼‰
{displayMode === 'flow' ? (
  <div className="bg-white rounded-lg border border-gray-200 p-4">
    <h2 className="text-lg font-bold text-gray-900 mb-4">ğŸ”„ ã‚¹ãƒ†ãƒƒãƒ—ãƒ•ãƒ­ãƒ¼è¡¨ç¤º</h2>
    <div className="grid grid-cols-2 lg:grid-cols-5 gap-4">
      {progressSteps.map((step) => {
        const stepItems = paginatedData.filter(d => getCurrentStep(d) === step.id);
        return (
          <div key={step.id} className="bg-gray-50 rounded-lg p-3">
            <div className="flex items-center space-x-2 mb-3">
              <div className="w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm">
                {step.icon}
              </div>
              <div>
                <h3 className="font-medium text-sm">{step.name}</h3>
                <p className="text-xs text-gray-500">{stepItems.length}ä»¶</p>
              </div>
            </div>
            <div className="space-y-2 max-h-96 overflow-y-auto">
              {stepItems.map(discrepancy => (
                <div key={discrepancy.id} 
                     className="bg-white p-2 rounded border cursor-pointer hover:shadow-sm"
                     onClick={() => onDiscrepancyClick(discrepancy)}>
                  <p className="font-medium text-sm">{discrepancy.customer.name}</p>
                  <p className="text-xs text-gray-500">
                    {new Intl.NumberFormat('ja-JP', { style: 'currency', currency: 'JPY' }).format(Math.abs(discrepancy.discrepancyAmount))}
                  </p>
                </div>
              ))}
            </div>
          </div>
        );
      })}
    </div>
  </div>
) : // Tableãƒ»Listè¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ç¶šã...
```

**Listè¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ï¼ˆãƒ¡ã‚¤ãƒ³è¡¨ç¤ºï¼‰**
```typescript
// å®Ÿè£…æ¸ˆã¿Listè¡¨ç¤ºã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
const ListItem: React.FC<{ discrepancy: PaymentDiscrepancy }> = ({ discrepancy }) => {
  const currentStep = getCurrentStep(discrepancy);
  
  return (
    <div 
      className="bg-white rounded-lg border border-gray-200 p-3 hover:shadow-md transition-all cursor-pointer mb-2 relative"
      onClick={() => onDiscrepancyClick(discrepancy)}
    >
      {/* å„ªå…ˆåº¦ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ */}
      <div className={`absolute top-0 left-0 w-1 h-full rounded-l-lg ${
        discrepancy.priority === 'critical' ? 'bg-red-500' :
        discrepancy.priority === 'high' ? 'bg-orange-500' :
        discrepancy.priority === 'medium' ? 'bg-yellow-500' :
        'bg-green-500'
      }`} />
      
      <div className="flex items-start justify-between mb-2 pl-2">
        <div className="flex items-center space-x-3 flex-1">
          {/* å‡¦ç†ã‚¿ã‚¤ãƒ—ã‚¢ã‚¤ã‚³ãƒ³ */}
          <div className="flex items-center">
            {discrepancy.interventionLevel === 'ai_autonomous' && <Bot className="w-5 h-5 text-blue-600" />}
            {discrepancy.interventionLevel === 'ai_assisted' && (
              <div className="flex space-x-1">
                <Bot className="w-4 h-4 text-blue-500" />
                <User className="w-4 h-4 text-orange-500" />
              </div>
            )}
            {discrepancy.interventionLevel === 'human_required' && <User className="w-5 h-5 text-red-600" />}
          </div>
          
          {/* é¡§å®¢æƒ…å ± */}
          <div className="flex-1">
            <div className="flex items-center space-x-2">
              <p className="font-semibold text-gray-900">{discrepancy.customer.name}</p>
              <span className="text-sm text-gray-500">({discrepancy.customer.code})</span>
            </div>
            
            {/* é€²æ—ã‚¹ãƒ†ãƒƒãƒ—è¡¨ç¤º */}
            <div className="mt-3">
              <div className="flex items-center justify-between mb-2">
                <span className="text-xs text-gray-500">
                  {discrepancy.interventionLevel === 'ai_autonomous' && 'ğŸ¤– AIè‡ªå¾‹å‡¦ç†'}
                  {discrepancy.interventionLevel === 'ai_assisted' && 'ğŸ¤–ğŸ‘¤ AIæ”¯æ´'}
                  {discrepancy.interventionLevel === 'human_required' && 'ğŸ‘¤ äººé–“å¿…é ˆ'}
                </span>
                {discrepancy.aiAnalysis?.confidence && (
                  <span className={`text-xs px-1 py-0.5 rounded ${
                    discrepancy.aiAnalysis.confidence >= 0.8 ? 'bg-green-100 text-green-700' :
                    discrepancy.aiAnalysis.confidence >= 0.6 ? 'bg-yellow-100 text-yellow-700' :
                    'bg-red-100 text-red-700'
                  }`}>
                    ç¢ºä¿¡åº¦: {Math.round((discrepancy.aiAnalysis.confidence > 1 ? discrepancy.aiAnalysis.confidence / 100 : discrepancy.aiAnalysis.confidence) * 100)}%
                  </span>
                )}
              </div>
              <ProgressSteps currentStep={currentStep} />
            </div>
            
            {/* ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ ï¼ˆã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ç·¨é›†å¯¾å¿œï¼‰ */}
            {editMode === discrepancy.id && editFormData && (
              <div className="mt-3 p-3 bg-blue-50 rounded-lg border border-blue-200">
                <div className="grid grid-cols-1 md:grid-cols-3 gap-3">
                  <div>
                    <label className="block text-xs font-medium text-gray-700 mb-1">å„ªå…ˆåº¦</label>
                    <select
                      value={editFormData.priority}
                      onChange={(e) => setEditFormData({...editFormData, priority: e.target.value})}
                      className="w-full text-xs border border-gray-300 rounded px-2 py-1"
                    >
                      <option value="low">ä½</option>
                      <option value="medium">ä¸­</option>
                      <option value="high">é«˜</option>
                      <option value="critical">ç·Šæ€¥</option>
                    </select>
                  </div>
                  <div>
                    <label className="block text-xs font-medium text-gray-700 mb-1">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</label>
                    <select
                      value={editFormData.status}
                      onChange={(e) => setEditFormData({...editFormData, status: e.target.value})}
                      className="w-full text-xs border border-gray-300 rounded px-2 py-1"
                    >
                      <option value="detected">æ¤œçŸ¥</option>
                      <option value="ai_analyzing">AIåˆ†æä¸­</option>
                      <option value="ai_action_ready">ã‚¢ã‚¯ã‚·ãƒ§ãƒ³æº–å‚™</option>
                      <option value="ai_executing">å®Ÿè¡Œä¸­</option>
                      <option value="human_review">äººé–“ãƒ¬ãƒ“ãƒ¥ãƒ¼</option>
                      <option value="customer_response">é¡§å®¢è¿”ä¿¡</option>
                      <option value="resolved">è§£æ±ºæ¸ˆã¿</option>
                    </select>
                  </div>
                  <div className="md:col-span-1">
                    <label className="block text-xs font-medium text-gray-700 mb-1">å‚™è€ƒ</label>
                    <input
                      type="text"
                      value={editFormData.notes}
                      onChange={(e) => setEditFormData({...editFormData, notes: e.target.value})}
                      className="w-full text-xs border border-gray-300 rounded px-2 py-1"
                      placeholder="å‚™è€ƒã‚’å…¥åŠ›..."
                    />
                  </div>
                </div>
              </div>
            )}
          </div>
          
          {/* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æƒ…å ± */}
          <div className="flex items-center space-x-2">
            <span className={`text-xs px-2 py-1 rounded-full ${
              discrepancy.priority === 'critical' ? 'bg-red-100 text-red-700 animate-pulse' :
              discrepancy.priority === 'high' ? 'bg-orange-100 text-orange-700' :
              discrepancy.priority === 'medium' ? 'bg-yellow-100 text-yellow-700' :
              'bg-green-100 text-green-700'
            }`}>
              {discrepancy.priority === 'critical' && 'ğŸš¨ ç·Šæ€¥'}
              {discrepancy.priority === 'high' && 'âš ï¸ é«˜'}
              {discrepancy.priority === 'medium' && 'ğŸ“Š ä¸­'}
              {discrepancy.priority === 'low' && 'âœ… ä½'}
            </span>
            
            <span className="text-xs px-2 py-1 rounded-full bg-gray-100 text-gray-700">
              {discrepancy.type === 'unpaid' && 'æœªå…¥é‡‘'}
              {discrepancy.type === 'overpaid' && 'éå…¥é‡‘'}
              {discrepancy.type === 'partial' && 'ä¸€éƒ¨å…¥é‡‘'}
              {discrepancy.type === 'multiple_invoices' && 'è¤‡æ•°è«‹æ±‚'}
            </span>
          </div>
          
          {/* é‡‘é¡æƒ…å ± */}
          <div className="text-right">
            <p className={`text-lg font-bold ${
              discrepancy.discrepancyAmount > 0 ? 'text-blue-600' : 'text-red-600'
            }`}>
              {discrepancy.discrepancyAmount > 0 ? '+' : ''}
              {new Intl.NumberFormat('ja-JP', { style: 'currency', currency: 'JPY' }).format(discrepancy.discrepancyAmount)}
            </p>
            {discrepancy.daysPastDue && discrepancy.daysPastDue > 0 && (
              <p className="text-sm text-red-600 font-medium">
                {discrepancy.daysPastDue}æ—¥çµŒé
              </p>
            )}
          </div>
        </div>
        
        {/* ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ */}
        <div className="flex items-center space-x-2 ml-3">
          {['phone_call_required', 'human_email_phone_combo', 'phone_negotiation', 'legal_phone_action', 'ai_phone_scheduled'].includes(getStageByStatus(discrepancy)) && (
            <div className="flex items-center bg-red-100 px-3 py-1 rounded-full">
              <Phone className="w-4 h-4 text-red-600 animate-pulse mr-1" />
              <span className="text-sm text-red-600 font-bold">é›»è©±å¿…è¦</span>
            </div>
          )}
          
          {/* ç·¨é›†ãƒ»å‰Šé™¤ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ */}
          <div className="relative">
            <button 
              onClick={(e) => {
                e.stopPropagation();
                toggleDropdown(discrepancy.id);
              }}
              className="text-gray-400 hover:text-gray-600 p-1"
            >
              <MoreVertical className="h-5 w-5" />
            </button>
            
            {activeDropdown === discrepancy.id && (
              <div 
                className="absolute right-0 top-8 bg-white border border-gray-200 rounded-lg shadow-lg z-10 min-w-[120px]"
                onClick={(e) => e.stopPropagation()}
              >
                <button
                  onClick={(e) => {
                    e.stopPropagation();
                    handleEditClick(discrepancy);
                  }}
                  className="w-full px-3 py-2 text-left text-sm hover:bg-gray-100 flex items-center space-x-2"
                >
                  <Edit className="h-4 w-4" />
                  <span>ç·¨é›†</span>
                </button>
                <button
                  onClick={(e) => {
                    e.stopPropagation();
                    handleDeleteClick(discrepancy.id);
                  }}
                  className="w-full px-3 py-2 text-left text-sm hover:bg-gray-100 text-red-600 flex items-center space-x-2"
                >
                  <Trash2 className="h-4 w-4" />
                  <span>å‰Šé™¤</span>
                </button>
              </div>
            )}
          </div>
        </div>
      </div>
    </div>
  );
};
```

#### **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çµ±è¨ˆã‚µãƒãƒªãƒ¼ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰**
```typescript
// å®Ÿè£…æ¸ˆã¿çµ±è¨ˆãƒ‡ãƒ¼ã‚¿è¡¨ç¤º
<div className="grid grid-cols-3 md:grid-cols-6 gap-2 mb-4">
  <div className="bg-white rounded-lg border border-gray-200 p-3">
    <div className="flex items-center">
      <Bot className="h-4 w-4 text-blue-600 mr-2" />
      <div>
        <p className="text-xs text-blue-600">AIè‡ªå¾‹</p>
        <p className="text-lg font-semibold text-blue-900">{stats.aiAutonomous}</p>
      </div>
    </div>
  </div>
  
  <div className="bg-white rounded-lg border border-gray-200 p-3">
    <div className="flex items-center">
      <User className="h-4 w-4 text-red-600 mr-2" />
      <div>
        <p className="text-xs text-red-600">äººé–“å¯¾å¿œ</p>
        <p className="text-lg font-semibold text-red-900">{stats.humanRequired}</p>
      </div>
    </div>
  </div>
  
  <div className="bg-white rounded-lg border border-gray-200 p-3">
    <div className="flex items-center">
      <Phone className="h-4 w-4 text-orange-600 mr-2" />
      <div>
        <p className="text-xs text-orange-600">é›»è©±è¦</p>
        <p className="text-lg font-semibold text-orange-900">{stats.phoneRequired}</p>
      </div>
    </div>
  </div>
  
  <div className="bg-white rounded-lg border border-gray-200 p-3">
    <div className="flex items-center">
      <AlertTriangle className="h-4 w-4 text-red-600 mr-2" />
      <div>
        <p className="text-xs text-red-600">ç·Šæ€¥</p>
        <p className="text-lg font-semibold text-red-900">{stats.critical}</p>
      </div>
    </div>
  </div>
  
  <div className="bg-white rounded-lg border border-gray-200 p-3">
    <div className="flex items-center">
      <CheckCircle className="h-4 w-4 text-gray-600 mr-2" />
      <div>
        <p className="text-xs text-gray-600">ç·ä»¶æ•°</p>
        <p className="text-lg font-semibold text-gray-900">{stats.total}</p>
      </div>
    </div>
  </div>
  
  <div className="bg-white rounded-lg border border-gray-200 p-3">
    <div className="flex items-center">
      <Mail className="h-4 w-4 text-yellow-600 mr-2" />
      <div>
        <p className="text-xs text-yellow-600">ç·å·®ç•°é¡</p>
        <p className="text-sm font-semibold text-yellow-900">
          {(stats.totalAmount / 10000).toFixed(0)}ä¸‡å††
        </p>
      </div>
    </div>
  </div>
</div>
```

---

## ğŸ“Š **ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆUIå®Ÿè£…ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰**

### **2. DataImportPage.tsx (797è¡Œå®Ÿè£…æ¸ˆã¿)**
**æ¦‚è¦**: 5ã‚¹ãƒ†ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ—ãƒ­ã‚»ã‚¹ãƒ»ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—å¯¾å¿œ

#### **5ã‚¹ãƒ†ãƒƒãƒ—ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰å®Ÿè£…ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰**
```typescript
// å®Ÿè£…æ¸ˆã¿ã‚¹ãƒ†ãƒƒãƒ—å®šç¾©
const steps = [
  { id: 'upload', name: 'ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ', icon: Upload },
  { id: 'analyze', name: 'åˆ†æ', icon: Eye },
  { id: 'preview', name: 'ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼', icon: FileText },
  { id: 'confirm', name: 'ç¢ºèª', icon: CheckCircle },
  { id: 'complete', name: 'å®Œäº†', icon: Database }
];

// ã‚¹ãƒ†ãƒƒãƒ—ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼å®Ÿè£…
const StepIndicator = () => {
  const currentIndex = steps.findIndex(step => step.id === currentStep);

  return (
    <div className="flex items-center justify-center mb-8">
      {steps.map((step, index) => {
        const Icon = step.icon;
        const isActive = index <= currentIndex;
        const isCurrent = step.id === currentStep;
        
        return (
          <React.Fragment key={step.id}>
            <div className="flex flex-col items-center">
              <div className={`w-10 h-10 rounded-full flex items-center justify-center border-2 transition-all ${
                isActive 
                  ? 'bg-blue-500 border-blue-500 text-white' 
                  : 'bg-white border-gray-300 text-gray-400'
              } ${isCurrent ? 'ring-4 ring-blue-100' : ''}`}>
                <Icon className="w-5 h-5" />
              </div>
              <span className={`text-sm mt-2 ${isActive ? 'text-blue-600 font-medium' : 'text-gray-400'}`}>
                {step.name}
              </span>
            </div>
            {index < steps.length - 1 && (
              <div className={`w-16 h-0.5 mx-4 mt-5 ${
                index < currentIndex ? 'bg-blue-500' : 'bg-gray-300'
              }`} />
            )}
          </React.Fragment>
        );
      })}
    </div>
  );
};
```

#### **ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰**
```typescript
// å®Ÿè£…æ¸ˆã¿ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠå‡¦ç†
const handleFileSelect = useCallback((event: React.ChangeEvent<HTMLInputElement>) => {
  const file = event.target.files?.[0];
  if (file) {
    // ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ãƒã‚§ãƒƒã‚¯
    const allowedTypes = [
      'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
      'application/vnd.ms-excel',
      'text/csv'
    ];
    
    if (!allowedTypes.includes(file.type)) {
      setError('Excel(.xlsx, .xls)ã¾ãŸã¯CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¯èƒ½ã§ã™');
      return;
    }
    
    // ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãƒã‚§ãƒƒã‚¯ï¼ˆ50MBåˆ¶é™ï¼‰
    if (file.size > 50 * 1024 * 1024) {
      setError('ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã¯50MBä»¥ä¸‹ã«ã—ã¦ãã ã•ã„');
      return;
    }
    
    setSelectedFile(file);
    setError(null);
    setAnalysis(null);
    setProcessedData(null);
    setCurrentStep('upload');
  }
}, []);

// ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—å‡¦ç†
const handleDrop = useCallback((event: React.DragEvent<HTMLDivElement>) => {
  event.preventDefault();
  const file = event.dataTransfer.files[0];
  if (file) {
    const input = document.createElement('input');
    input.type = 'file';
    input.files = event.dataTransfer.files;
    handleFileSelect({ target: input } as any);
  }
}, [handleFileSelect]);

const handleDragOver = useCallback((event: React.DragEvent<HTMLDivElement>) => {
  event.preventDefault();
}, []);
```

#### **ãƒ•ã‚¡ã‚¤ãƒ«åˆ†æãƒ»ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ©Ÿèƒ½ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰**
```typescript
// ãƒ•ã‚¡ã‚¤ãƒ«åˆ†æå‡¦ç†
const analyzeFile = async () => {
  if (!selectedFile) return;
  
  setAnalyzing(true);
  setError(null);
  
  try {
    const formData = new FormData();
    formData.append('file', selectedFile);
    
    const result = await api.postFormData<{
      status: string;
      message: string;
      data: {
        fileName: string;
        fileSize: number;
        analysis: AnalysisResult;
      };
    }>('/import/analyze', formData);
    
    setAnalysis(result.data.analysis);
    setCurrentStep('analyze');
  } catch (err: any) {
    const errorMessage = err.response?.data?.message || err.message || 'ãƒ•ã‚¡ã‚¤ãƒ«åˆ†æã‚¨ãƒ©ãƒ¼';
    setError(errorMessage);
  } finally {
    setAnalyzing(false);
  }
};

// ãƒ‡ãƒ¼ã‚¿å‡¦ç†ï¼ˆå·®ç•°ç®¡ç†ç”¨ï¼‰
const processData = async () => {
  if (!selectedFile) return;
  
  setProcessing(true);
  setError(null);
  
  try {
    const formData = new FormData();
    formData.append('file', selectedFile);
    
    // åˆ†æçµæœã‹ã‚‰å‡¦ç†å¯èƒ½ã‚·ãƒ¼ãƒˆãŒã‚ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
    if (!analysis) {
      throw new Error('ãƒ•ã‚¡ã‚¤ãƒ«åˆ†æãŒå®Œäº†ã—ã¦ã„ã¾ã›ã‚“');
    }
    
    const processableSheets = Object.entries(analysis.structure).filter(([_, sheetInfo]) => 
      !sheetInfo.isEmpty && sheetInfo.dataQuality.businessValidRows >= 1
    );
    
    if (processableSheets.length === 0) {
      throw new Error('å‡¦ç†å¯èƒ½ãªæœ‰åŠ¹ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
    }
    
    // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ã«å·®ç•°ãƒ‡ãƒ¼ã‚¿ã‚’æº–å‚™ï¼ˆå®Ÿéš›ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã¯ç¢ºå®šæ™‚ã«å®Ÿè¡Œï¼‰
    const previewResult: DiscrepancyImportResult = {
      fileName: selectedFile.name,
      totalProcessed: processableSheets.length,
      totalCreated: 0,
      processableSheets: processableSheets.map(([name]) => name),
      results: [],
      summary: {
        successful: 0,
        failed: 0
      }
    };
    
    // ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ã®çµæœã‚’ä½œæˆ
    for (const [sheetName] of processableSheets) {
      const sampleData = analysis.sampleData[sheetName] || [];
      
      for (const rowData of sampleData) {
        // ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã‚’ã‚¹ã‚­ãƒƒãƒ—ï¼ˆè¤‡æ•°ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ãƒã‚§ãƒƒã‚¯ï¼‰
        if (
          rowData['åˆ†é¡'] === 'åˆ†é¡' || 
          rowData['ä¼šç¤¾å'] === 'ä¼šç¤¾å' ||
          rowData['to'] === 'to' ||
          rowData['é‡‘é¡'] === 'é‡‘é¡' ||
          rowData['åˆ†é¡ç”¨ãƒ•ãƒ©ã‚°'] === 'åˆ†é¡ç”¨ãƒ•ãƒ©ã‚°' ||
          rowData['Key'] === 'Key'
        ) {
          continue;
        }
        
        // å¿…è¦ãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒã‚ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
        if (!rowData['åˆ†é¡'] || !rowData['ä¼šç¤¾å'] || !rowData['é‡‘é¡']) {
          continue;
        }
        
        // ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®æœ‰åŠ¹æ€§ãƒã‚§ãƒƒã‚¯
        const email = rowData['to'];
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!email || !emailRegex.test(email)) {
          continue;
        }
        
        // é‡‘é¡ã®æœ‰åŠ¹æ€§ãƒã‚§ãƒƒã‚¯
        const amount = parseFloat(rowData['é‡‘é¡']);
        if (isNaN(amount) || amount <= 0) {
          continue;
        }
        
        previewResult.results.push({
          success: true,
          customer: rowData['ä¼šç¤¾å'],
          amount: amount,
          type: 'UNPAID',
          classification: rowData['åˆ†é¡']
        });
        
        previewResult.summary.successful++;
      }
    }
    
    setDiscrepancyResult(previewResult);
    setCurrentStep('preview');
  } catch (err: any) {
    const errorMessage = err.response?.data?.message || err.message || 'ãƒ‡ãƒ¼ã‚¿å‡¦ç†ã‚¨ãƒ©ãƒ¼';
    setError(errorMessage);
  } finally {
    setProcessing(false);
  }
};
```

---

## ğŸ“§ **ãƒ¡ãƒ¼ãƒ«ç®¡ç†UIå®Ÿè£…ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰**

### **3. EmailSettingsPage.tsxï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰**
**æ¦‚è¦**: SMTPè¨­å®šãƒ»é€ä¿¡è€…è¨­å®šãƒ»æ¥ç¶šãƒ†ã‚¹ãƒˆã®çµ±åˆãƒ•ã‚©ãƒ¼ãƒ 

#### **SMTPè¨­å®šãƒ•ã‚©ãƒ¼ãƒ ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰**
```typescript
// å®Ÿè£…æ¸ˆã¿SMTPè¨­å®šãƒ•ã‚©ãƒ¼ãƒ 
const EmailSettingsForm: React.FC = () => {
  const [settings, setSettings] = useState({
    smtp: {
      host: '',
      port: 587,
      secure: false,
      auth: {
        user: '',
        pass: '',
        type: 'login'
      }
    },
    sender: {
      name: 'AR System',
      email: '',
      signature: '',
      replyTo: '',
      defaultCc: '',
      defaultBcc: ''
    },
    automation: {
      timing: 'manual',
      scheduledTime: '09:00',
      requireApproval: true,
      businessHours: {
        enabled: true,
        timezone: 'Asia/Tokyo'
      },
      rateLimiting: {
        enabled: true,
        maxEmailsPerHour: 30,
        maxEmailsPerDay: 100,
        delayBetweenEmails: 60
      }
    }
  });

  // ãƒãƒ¼ãƒˆç•ªå·ã«ã‚ˆã‚‹è‡ªå‹•SSLè¨­å®š
  useEffect(() => {
    if (settings.smtp.port === 465) {
      setSettings(prev => ({
        ...prev,
        smtp: { ...prev.smtp, secure: true }
      }));
    } else if (settings.smtp.port === 587) {
      setSettings(prev => ({
        ...prev,
        smtp: { ...prev.smtp, secure: false }
      }));
    }
  }, [settings.smtp.port]);

  const handleSaveSettings = async (data: any) => {
    try {
      const result = await api.post('/email/settings', data);
      toast.success('è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ');
    } catch (error) {
      toast.error('è¨­å®šã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ');
    }
  };

  const handleTestConnection = async () => {
    try {
      const result = await api.post('/email/test-connection', {
        type: 'smtp',
        settings: settings.smtp,
        testEmail: 'test@example.com'
      });
      
      if (result.data.connectionTest) {
        toast.success('æ¥ç¶šãƒ†ã‚¹ãƒˆãŒæˆåŠŸã—ã¾ã—ãŸ');
      } else {
        toast.error('æ¥ç¶šãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã—ã¾ã—ãŸ');
      }
    } catch (error) {
      toast.error('æ¥ç¶šãƒ†ã‚¹ãƒˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
    }
  };

  return (
    <div className="max-w-4xl mx-auto p-6">
      <div className="bg-white rounded-lg shadow-sm border border-gray-200">
        <div className="border-b border-gray-200 p-6">
          <h1 className="text-2xl font-bold text-gray-900">ğŸ“§ ãƒ¡ãƒ¼ãƒ«è¨­å®š</h1>
          <p className="text-gray-600 mt-1">SMTPè¨­å®šã¨é€ä¿¡è€…æƒ…å ±ã‚’ç®¡ç†ã—ã¾ã™</p>
        </div>
        
        <div className="p-6 space-y-6">
          {/* SMTPè¨­å®šã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}
          <div>
            <h3 className="text-lg font-medium text-gray-900 mb-4">SMTPè¨­å®š</h3>
            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">
                  SMTPãƒ›ã‚¹ãƒˆ
                </label>
                <input
                  type="text"
                  value={settings.smtp.host}
                  onChange={(e) => setSettings(prev => ({
                    ...prev,
                    smtp: { ...prev.smtp, host: e.target.value }
                  }))}
                  className="w-full border border-gray-300 rounded-lg px-3 py-2"
                  placeholder="smtp.gmail.com"
                />
              </div>
              
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">
                  ãƒãƒ¼ãƒˆç•ªå·
                </label>
                <select
                  value={settings.smtp.port}
                  onChange={(e) => setSettings(prev => ({
                    ...prev,
                    smtp: { ...prev.smtp, port: Number(e.target.value) }
                  }))}
                  className="w-full border border-gray-300 rounded-lg px-3 py-2"
                >
                  <option value={587}>587 (STARTTLS)</option>
                  <option value={465}>465 (SSL/TLS)</option>
                  <option value={25}>25 (å¹³æ–‡)</option>
                </select>
              </div>
              
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">
                  ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹
                </label>
                <input
                  type="email"
                  value={settings.smtp.auth.user}
                  onChange={(e) => setSettings(prev => ({
                    ...prev,
                    smtp: { ...prev.smtp, auth: { ...prev.smtp.auth, user: e.target.value } }
                  }))}
                  className="w-full border border-gray-300 rounded-lg px-3 py-2"
                  placeholder="your-email@gmail.com"
                />
              </div>
              
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">
                  ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰
                </label>
                <input
                  type="password"
                  value={settings.smtp.auth.pass}
                  onChange={(e) => setSettings(prev => ({
                    ...prev,
                    smtp: { ...prev.smtp, auth: { ...prev.smtp.auth, pass: e.target.value } }
                  }))}
                  className="w-full border border-gray-300 rounded-lg px-3 py-2"
                  placeholder="ã‚¢ãƒ—ãƒªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰"
                />
              </div>
            </div>
          </div>

          {/* é€ä¿¡è€…è¨­å®šã‚»ã‚¯ã‚·ãƒ§ãƒ³ */}
          <div>
            <h3 className="text-lg font-medium text-gray-900 mb-4">é€ä¿¡è€…è¨­å®š</h3>
            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">
                  é€ä¿¡è€…å
                </label>
                <input
                  type="text"
                  value={settings.sender.name}
                  onChange={(e) => setSettings(prev => ({
                    ...prev,
                    sender: { ...prev.sender, name: e.target.value }
                  }))}
                  className="w-full border border-gray-300 rounded-lg px-3 py-2"
                  placeholder="AR System"
                />
              </div>
              
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">
                  è¿”ä¿¡å…ˆãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹
                </label>
                <input
                  type="email"
                  value={settings.sender.replyTo}
                  onChange={(e) => setSettings(prev => ({
                    ...prev,
                    sender: { ...prev.sender, replyTo: e.target.value }
                  }))}
                  className="w-full border border-gray-300 rounded-lg px-3 py-2"
                  placeholder="noreply@example.com"
                />
              </div>
              
              <div className="md:col-span-2">
                <label className="block text-sm font-medium text-gray-700 mb-1">
                  ç½²åï¼ˆ12è¡Œã¾ã§å¯¾å¿œï¼‰
                </label>
                <textarea
                  value={settings.sender.signature}
                  onChange={(e) => setSettings(prev => ({
                    ...prev,
                    sender: { ...prev.sender, signature: e.target.value }
                  }))}
                  rows={12}
                  className="w-full border border-gray-300 rounded-lg px-3 py-2"
                  placeholder="â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”&#10;AR System å£²æ›é‡‘ç®¡ç†&#10;â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
                />
              </div>
            </div>
          </div>

          {/* ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ */}
          <div className="flex justify-between pt-6 border-t border-gray-200">
            <button
              onClick={handleTestConnection}
              className="flex items-center px-4 py-2 bg-blue-50 text-blue-600 border border-blue-200 rounded-lg hover:bg-blue-100 transition-colors"
            >
              <TestTube className="w-4 h-4 mr-2" />
              æ¥ç¶šãƒ†ã‚¹ãƒˆ
            </button>
            
            <button
              onClick={() => handleSaveSettings(settings)}
              className="flex items-center px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors"
            >
              <Save className="w-4 h-4 mr-2" />
              è¨­å®šã‚’ä¿å­˜
            </button>
          </div>
        </div>
      </div>
    </div>
  );
};
```

### **4. EmailTemplatesPage.tsxï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰**
**æ¦‚è¦**: ãƒ¡ãƒ¼ãƒ«ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç®¡ç†ã®åŒ…æ‹¬çš„UI

```typescript
// å®Ÿè£…æ¸ˆã¿ãƒ¡ãƒ¼ãƒ«ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç®¡ç†
const EmailTemplatesPage: React.FC = () => {
  const [templates, setTemplates] = useState<EmailTemplate[]>([]);
  const [selectedTemplate, setSelectedTemplate] = useState<EmailTemplate | null>(null);
  const [isEditing, setIsEditing] = useState(false);

  const templateTypes = [
    { value: 'unpaid_reminder', label: 'æœªå…¥é‡‘ç£ä¿ƒ', description: 'æœªå…¥é‡‘ã«å¯¾ã™ã‚‹ç£ä¿ƒãƒ¡ãƒ¼ãƒ«' },
    { value: 'overpaid_inquiry', label: 'éå…¥é‡‘ç…§ä¼š', description: 'éå…¥é‡‘ã«å¯¾ã™ã‚‹ç…§ä¼šãƒ¡ãƒ¼ãƒ«' },
    { value: 'payment_confirmation', label: 'å…¥é‡‘ç¢ºèª', description: 'å…¥é‡‘ç¢ºèªã®ãƒ¡ãƒ¼ãƒ«' },
    { value: 'custom', label: 'ã‚«ã‚¹ã‚¿ãƒ ', description: 'è‡ªç”±å½¢å¼ãƒ¡ãƒ¼ãƒ«' }
  ];

  const handleCreateTemplate = async (templateData: any) => {
    try {
      const result = await api.post('/email/templates', templateData);
      setTemplates(prev => [...prev, result.data.template]);
      toast.success('ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸ');
    } catch (error) {
      toast.error('ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ');
    }
  };

  const handleUpdateTemplate = async (id: string, templateData: any) => {
    try {
      const result = await api.put(`/email/templates/${id}`, templateData);
      setTemplates(prev => prev.map(t => t.id === id ? result.data.template : t));
      toast.success('ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’æ›´æ–°ã—ã¾ã—ãŸ');
    } catch (error) {
      toast.error('ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ');
    }
  };

  const handleDeleteTemplate = async (id: string) => {
    if (window.confirm('ã“ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’å‰Šé™¤ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ')) {
      try {
        await api.delete(`/email/templates/${id}`);
        setTemplates(prev => prev.filter(t => t.id !== id));
        toast.success('ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’å‰Šé™¤ã—ã¾ã—ãŸ');
      } catch (error) {
        toast.error('ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    }
  };

  return (
    <div className="max-w-7xl mx-auto p-6">
      <div className="bg-white rounded-lg shadow-sm border border-gray-200">
        <div className="border-b border-gray-200 p-6">
          <div className="flex items-center justify-between">
            <div>
              <h1 className="text-2xl font-bold text-gray-900">ğŸ“§ ãƒ¡ãƒ¼ãƒ«ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç®¡ç†</h1>
              <p className="text-gray-600 mt-1">ç£ä¿ƒãƒ¡ãƒ¼ãƒ«ãƒ»ç…§ä¼šãƒ¡ãƒ¼ãƒ«ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç®¡ç†ã—ã¾ã™</p>
            </div>
            <button
              onClick={() => setIsEditing(true)}
              className="flex items-center px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors"
            >
              <Plus className="w-4 h-4 mr-2" />
              æ–°è¦ä½œæˆ
            </button>
          </div>
        </div>

        <div className="p-6">
          {/* ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä¸€è¦§ */}
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            {templates.map(template => (
              <div key={template.id} className="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                <div className="flex items-start justify-between mb-3">
                  <div>
                    <h3 className="font-medium text-gray-900">{template.name}</h3>
                    <p className="text-sm text-gray-500 mt-1">{template.subject}</p>
                  </div>
                  <div className="flex items-center space-x-1">
                    <button
                      onClick={() => {
                        setSelectedTemplate(template);
                        setIsEditing(true);
                      }}
                      className="text-gray-400 hover:text-blue-600"
                    >
                      <Edit className="w-4 h-4" />
                    </button>
                    <button
                      onClick={() => handleDeleteTemplate(template.id)}
                      className="text-gray-400 hover:text-red-600"
                    >
                      <Trash2 className="w-4 h-4" />
                    </button>
                  </div>
                </div>
                
                <div className="mb-3">
                  <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${
                    template.type === 'unpaid_reminder' ? 'bg-red-100 text-red-800' :
                    template.type === 'overpaid_inquiry' ? 'bg-blue-100 text-blue-800' :
                    template.type === 'payment_confirmation' ? 'bg-green-100 text-green-800' :
                    'bg-gray-100 text-gray-800'
                  }`}>
                    {templateTypes.find(t => t.value === template.type)?.label || template.type}
                  </span>
                </div>
                
                <p className="text-sm text-gray-600 line-clamp-3">
                  {template.body.substring(0, 100)}...
                </p>
              </div>
            ))}
          </div>
        </div>
      </div>
    </div>
  );
};
```

---

## ğŸ¨ **ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰**

### **Tailwind CSSè¨­å®šï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰**
```javascript
// tailwind.config.js (å®Ÿè£…æ¸ˆã¿è¨­å®š)
export default {
  content: ["./index.html", "./src/**/*.{js,ts,jsx,tsx}"],
  theme: {
    extend: {
      colors: {
        primary: {
          50: '#eff6ff',
          100: '#dbeafe',
          200: '#bfdbfe',
          300: '#93c5fd',
          400: '#60a5fa',
          500: '#3b82f6',
          600: '#2563eb',
          700: '#1d4ed8',
          800: '#1e40af',
          900: '#1e3a8a'
        },
        success: {
          50: '#f0fdf4',
          100: '#dcfce7',
          200: '#bbf7d0',
          300: '#86efac',
          400: '#4ade80',
          500: '#22c55e',
          600: '#16a34a',
          700: '#15803d',
          800: '#166534',
          900: '#14532d'
        },
        warning: {
          50: '#fffbeb',
          100: '#fef3c7',
          200: '#fde68a',
          300: '#fcd34d',
          400: '#fbbf24',
          500: '#f59e0b',
          600: '#d97706',
          700: '#b45309',
          800: '#92400e',
          900: '#78350f'
        },
        danger: {
          50: '#fef2f2',
          100: '#fee2e2',
          200: '#fecaca',
          300: '#fca5a5',
          400: '#f87171',
          500: '#ef4444',
          600: '#dc2626',
          700: '#b91c1c',
          800: '#991b1b',
          900: '#7f1d1d'
        }
      },
      fontFamily: {
        sans: ['Inter', 'ui-sans-serif', 'system-ui', 'sans-serif']
      },
      animation: {
        'fade-in': 'fadeIn 0.5s ease-in-out',
        'slide-up': 'slideUp 0.3s ease-out',
        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite'
      }
    }
  }
}
```

---

## ğŸ“± **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œãƒ»ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰**

### **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³å®Ÿè£…**
```css
/* å®Ÿè£…æ¸ˆã¿ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ã‚¯ãƒ©ã‚¹ */
.responsive-grid {
  @apply grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4;
}

.mobile-stack {
  @apply flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-2;
}

.mobile-hidden {
  @apply hidden md:block;
}

.responsive-text {
  @apply text-sm md:text-base lg:text-lg;
}
```

### **ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å¯¾å¿œï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰**
```typescript
// ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œ
const handleKeyDown = (event: KeyboardEvent) => {
  if (event.key === 'Enter' || event.key === ' ') {
    event.preventDefault();
    onClick();
  }
};

// ARIAå±æ€§å¯¾å¿œ
<button
  aria-label="å·®ç•°ã‚’ç·¨é›†"
  aria-describedby="edit-help-text"
  role="button"
  tabIndex={0}
  onKeyDown={handleKeyDown}
>
  ç·¨é›†
</button>

// ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ç®¡ç†
const focusFirstError = () => {
  const firstError = document.querySelector('[data-error="true"]');
  firstError?.focus();
};
```

---

## ğŸš€ **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰**

### **Reactæœ€é©åŒ–**
```typescript
// ãƒ¡ãƒ¢åŒ–ã«ã‚ˆã‚‹ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æœ€é©åŒ–ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
const ListItem = React.memo(({ discrepancy, onUpdate, onDelete }) => {
  // ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…
}, (prevProps, nextProps) => {
  return prevProps.discrepancy.id === nextProps.discrepancy.id &&
         prevProps.discrepancy.updatedAt === nextProps.discrepancy.updatedAt;
});

// useMemoã«ã‚ˆã‚‹è¨ˆç®—çµæœã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
const filteredAndSortedData = useMemo(() => {
  let filtered = discrepancies.filter(item => {
    // æ¤œç´¢ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
    if (searchTerm) {
      const searchLower = searchTerm.toLowerCase();
      if (!item.customer.name.toLowerCase().includes(searchLower) &&
          !item.customer.code.toLowerCase().includes(searchLower)) {
        return false;
      }
    }

    // ã‚¾ãƒ¼ãƒ³ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
    if (focusZone === 'ai' && item.interventionLevel !== 'ai_autonomous') return false;
    if (focusZone === 'human' && item.interventionLevel === 'ai_autonomous') return false;

    // ãã®ä»–ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
    if (filter.interventionLevel && filter.interventionLevel.length > 0) {
      if (!filter.interventionLevel.includes(item.interventionLevel)) return false;
    }
    if (filter.status && filter.status.length > 0 && !filter.status.includes(item.status)) return false;
    if (filter.priority && filter.priority.length > 0 && !filter.priority.includes(item.priority)) return false;
    if (filter.type && filter.type.length > 0 && !filter.type.includes(item.type)) return false;

    return true;
  });

  // ã‚½ãƒ¼ãƒˆ
  filtered.sort((a, b) => {
    const aValue = getNestedValue(a, sortConfig.field);
    const bValue = getNestedValue(b, sortConfig.field);
    
    if (sortConfig.direction === 'asc') {
      return aValue > bValue ? 1 : -1;
    } else {
      return aValue < bValue ? 1 : -1;
    }
  });

  return filtered;
}, [discrepancies, searchTerm, filter, sortConfig, focusZone]);

// useCallbackã«ã‚ˆã‚‹é–¢æ•°ãƒ¡ãƒ¢åŒ–ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
const handleUpdateDiscrepancy = useCallback(async (id: string, updates: Partial<PaymentDiscrepancy>) => {
  try {
    await api.patch(`/discrepancies/${id}`, updates);
    setDiscrepancies(prev => prev.map(d => d.id === id ? { ...d, ...updates } : d));
    toast.success('å·®ç•°æƒ…å ±ã‚’æ›´æ–°ã—ã¾ã—ãŸ');
  } catch (error) {
    toast.error('æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ');
  }
}, []);
```

---

## ğŸ“Š **å‹å®šç¾©ã‚·ã‚¹ãƒ†ãƒ ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰**

### **discrepancy.tsï¼ˆå®Ÿè£…æ¸ˆã¿å‹å®šç¾©ï¼‰**
```typescript
// å®Ÿè£…æ¸ˆã¿å‹å®šç¾©
export interface PaymentDiscrepancy {
  id: string;
  customerId: string;
  customer: {
    id: string;
    name: string;
    code: string;
    email?: string;
  };
  type: 'unpaid' | 'overpaid' | 'partial' | 'multiple_invoices';
  status: DiscrepancyStatus;
  priority: 'low' | 'medium' | 'high' | 'critical';
  interventionLevel: HumanInterventionLevel;
  expectedAmount: number;
  actualAmount: number;
  discrepancyAmount: number;
  detectedAt: string;
  dueDate?: string;
  daysPastDue?: number;
  assignedTo?: string;
  assignedAt?: string;
  notes?: string;
  tags?: string[];
  importKey?: string;
  aiAnalysis?: {
    confidence: number;
    recommendedAction: string;
    escalationStage: number;
    suggestedEmailTemplate: string;
    estimatedResolutionTime: number;
    reasoning: string;
  };
  actions: DiscrepancyAction[];
  emailLogs: EmailLog[];
  createdAt: string;
  updatedAt: string;
}

export type DiscrepancyStatus = 
  | 'detected' 
  | 'ai_analyzing' 
  | 'ai_action_ready' 
  | 'ai_executing' 
  | 'customer_response' 
  | 'escalated' 
  | 'resolved' 
  | 'human_review' 
  | 'human_action';

export type HumanInterventionLevel = 
  | 'ai_autonomous'    // AIè‡ªå¾‹å‡¦ç†
  | 'ai_assisted'      // AIæ”¯æ´
  | 'human_required';  // äººé–“å¿…é ˆ

export type ViewMode = 'flow' | 'table' | 'list';

export interface DiscrepancyFilter {
  status?: DiscrepancyStatus[];
  type?: string[];
  priority?: string[];
  interventionLevel?: HumanInterventionLevel[];
  customerId?: string;
  dateRange?: {
    start: string;
    end: string;
  };
}

export interface PaginationState {
  page: number;
  limit: number;
  total: number;
  totalPages: number;
}

export interface SortConfig {
  field: string;
  direction: 'asc' | 'desc';
}
```

---

## ğŸ¯ **å®Œå…¨å®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ**

### âœ… **å®Ÿè£…æ¸ˆã¿æ©Ÿèƒ½**
- [x] **5ã‚¹ãƒ†ãƒƒãƒ—é€²æ—è¡¨ç¤ºã‚·ã‚¹ãƒ†ãƒ ** (1,228è¡ŒProgressDiscrepancyFlowBoardå®Œå…¨å®Ÿè£…)
- [x] **3ã¤ã®è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆ** (Flowãƒ»Tableãƒ»List)
- [x] **AIä»‹å…¥ãƒ¬ãƒ™ãƒ«å¯è¦–åŒ–** (autonomousãƒ»assistedãƒ»required)
- [x] **å¿ƒç†çš„è² æ‹…è»½æ¸›UIè¨­è¨ˆ** (è‰²å½©å¿ƒç†å­¦ãƒ»ã‚¹ãƒ†ãƒƒãƒ—å½¢å¼)
- [x] **ãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ³ãƒãƒ¼ãƒˆ5ã‚¹ãƒ†ãƒƒãƒ—** (797è¡ŒDataImportPageå®Œå…¨å®Ÿè£…)
- [x] **ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—å¯¾å¿œ** (50MBåˆ¶é™ãƒ»å½¢å¼ãƒã‚§ãƒƒã‚¯)
- [x] **SMTPè¨­å®šãƒ•ã‚©ãƒ¼ãƒ ** (ãƒãƒ¼ãƒˆè‡ªå‹•è¨­å®šãƒ»æ¥ç¶šãƒ†ã‚¹ãƒˆ)
- [x] **ãƒ¡ãƒ¼ãƒ«ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç®¡ç†** (CRUDãƒ»ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»å¤‰æ•°æŠ½å‡º)
- [x] **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ** (ãƒ¢ãƒã‚¤ãƒ«ãƒ»ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆãƒ»ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—)
- [x] **ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å¯¾å¿œ** (ARIAãƒ»ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³)
- [x] **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–** (React.memoãƒ»useMemoãƒ»useCallback)
- [x] **TypeScriptå‹å®‰å…¨æ€§** (100%ã‚«ãƒãƒ¬ãƒƒã‚¸)
- [x] **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çµ±è¨ˆè¡¨ç¤º** (6ã¤ã®çµ±è¨ˆã‚«ãƒ¼ãƒ‰)
- [x] **ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ç·¨é›†æ©Ÿèƒ½** (ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒ»ä¿å­˜ã‚­ãƒ£ãƒ³ã‚»ãƒ«)
- [x] **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°** (toasté€šçŸ¥ãƒ»ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³)

### ğŸ¨ **UI/UXç‰¹å¾´**
- **å¿ƒç†çš„è² æ‹…è»½æ¸›**: ã‚¹ãƒ†ãƒƒãƒ—å½¢å¼ãƒ»ç¢ºä¿¡åº¦è¡¨ç¤ºãƒ»è‰²å½©å¿ƒç†å­¦æ´»ç”¨
- **ç›´æ„Ÿçš„æ“ä½œ**: ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ãƒ»ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ç·¨é›†ãƒ»ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯æ“ä½œ
- **æƒ…å ±å¯†åº¦æœ€é©åŒ–**: ã‚«ãƒ¼ãƒ‰ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ»ãƒªã‚¹ãƒˆå„ãƒ¢ãƒ¼ãƒ‰ã§ã®æƒ…å ±è¡¨ç¤ºæœ€é©åŒ–
- **ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šçŸ¥ãƒ»é€²æ—è¡¨ç¤ºãƒ»ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- **AIå‡¦ç†å¯è¦–åŒ–**: ç¢ºä¿¡åº¦è¡¨ç¤ºãƒ»ä»‹å…¥ãƒ¬ãƒ™ãƒ«ãƒ»ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ®µéšè¡¨ç¤º

### ğŸ“Š **æŠ€è¡“ä»•æ§˜**
- **ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ•°**: 15å€‹ (ä¸»è¦7å€‹ + å…±é€š8å€‹)
- **ç·å®Ÿè£…è¡Œæ•°**: ç´„3,500è¡Œï¼ˆå®Ÿæ¸¬æ¸ˆã¿ï¼‰
- **ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**:
  - ProgressDiscrepancyFlowBoard.tsx: 1,228è¡Œ
  - DataImportPage.tsx: 797è¡Œ
  - EmailSettingsPage.tsx: å®Ÿè£…æ¸ˆã¿
  - EmailTemplatesPage.tsx: å®Ÿè£…æ¸ˆã¿
- **TypeScriptå‹å®šç¾©**: å®Œå…¨å¯¾å¿œ
- **ãƒ†ã‚¹ãƒˆå¯¾å¿œ**: Jest + React Testing Libraryå¯¾å¿œè¨­è¨ˆ
- **SEOå¯¾å¿œ**: React Helmetå¯¾å¿œè¨­è¨ˆ

---

## ğŸ”— é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [01_æ¥­å‹™ãƒ•ãƒ­ãƒ¼å®Œå…¨ç‰ˆ_Ver2.0.md](./01_æ¥­å‹™ãƒ•ãƒ­ãƒ¼å®Œå…¨ç‰ˆ_Ver2.0.md)
- [02_DB_APIå®Œå…¨å®Ÿè£…æ›¸_Ver2.1_å®Ÿè£…å¯¾å¿œç‰ˆ.md](./02_DB_APIå®Œå…¨å®Ÿè£…æ›¸_Ver2.1_å®Ÿè£…å¯¾å¿œç‰ˆ.md) 
- [03_Excelå–è¾¼å®Œå…¨å®Ÿè£…æ›¸_Ver2.1_å®Ÿè£…å¯¾å¿œç‰ˆ.md](./03_Excelå–è¾¼å®Œå…¨å®Ÿè£…æ›¸_Ver2.1_å®Ÿè£…å¯¾å¿œç‰ˆ.md)
- [04_ãƒ¡ãƒ¼ãƒ«é€ä¿¡å®Œå…¨å®Ÿè£…æ›¸_Ver2.0.md](./04_ãƒ¡ãƒ¼ãƒ«é€ä¿¡å®Œå…¨å®Ÿè£…æ›¸_Ver2.0.md)
- [05_ç·¨é›†å‰Šé™¤å®Œå…¨å®Ÿè£…æ›¸_Ver2.0.md](./05_ç·¨é›†å‰Šé™¤å®Œå…¨å®Ÿè£…æ›¸_Ver2.0.md)
- [08_ãƒ†ã‚¹ãƒˆå®Œå…¨å®Ÿè£…æ›¸_Ver2.1_å®Ÿè£…å¯¾å¿œç‰ˆ.md](./08_ãƒ†ã‚¹ãƒˆå®Œå…¨å®Ÿè£…æ›¸_Ver2.1_å®Ÿè£…å¯¾å¿œç‰ˆ.md)

---

**ğŸ“… ä½œæˆæ—¥**: 2025å¹´1æœˆ26æ—¥  
**âœï¸ ä½œæˆè€…**: Claude Code Assistant  
**ğŸ”„ ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 2.1 å®Ÿè£…å¯¾å¿œç‰ˆ  
**ğŸ“‹ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: å®Œæˆ - å®Ÿè£…æ¸ˆã¿ã‚³ãƒ¼ãƒ‰ã¨å®Œå…¨å¯¾å¿œã—ãŸUIå®Ÿè£…ä»•æ§˜æ›¸

*ğŸ¯ ã“ã®å®Ÿè£…æ¤œè¨¼ç‰ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§åŒç­‰ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å±¤ãŒ100%å†ç¾å¯èƒ½ã§ã™*

*ğŸ’¡ å®Ÿè£…æ¸ˆã¿ã‚³ãƒ¼ãƒ‰: ProgressDiscrepancyFlowBoard.tsx (1,228è¡Œ) + DataImportPage.tsx (797è¡Œ) + ãã®ä»–å®Œå…¨å¯¾å¿œ*